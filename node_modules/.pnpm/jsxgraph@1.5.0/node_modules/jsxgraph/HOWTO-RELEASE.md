# Howto do a JSXGraph release

## Source code

- Change version in src/base/constants.js
- Change version in package.json
~~- Change version in COPYRIGHT~~
- Checkout main branch
- Merge develop branch into main branch
- Make commands:

```{.bash}
    touch src/reader/*.js
    make readers
    make release
    make moodle # fails
    git commit -a
    git push
```


## Update update_cdnjs (~obsolete~, NO still relevant)

```{.bash}
    cd distrib
    unzip jsxgraph.zip 
    cp geogebra.min.js  geonext.min.js  intergeo.min.js  \
        jsxgraphcore.js jsxgraphsrc.js jsxgraphcore.mjs jsxgraphsrc.mjs \
        jsxgraph.css sketch.min.js index.d.ts ../update_cdnjs
    cp -r themes ../update_cdnjs
    git commit -a
    git push
```

## GitHub

GitHub: Releases

- Create new Release and write release text
- Tag: vm.xx.yy
- Title: Release of vm.xx.yy

```{.bash}
    git tag RELEASE-vm.xx.yy
    git tag vm.xx.yy
    git push origin RELEASE-vm.xx.yy
    # git push origin vm.xx.yy // Existiert bereits durch github release
```

## dbnfs

- copy utils/makerelease.sh to dbnfs
- on dbnfs: sh makerelease.sh m.xx.yy 

## Website

- Update website on http://jsxgraph.org/wp (links for download and docs)
  - write blog post
  - update _config.yml, download.md, previousreleases.md
  - `bundler exec jekyll build`
  - git commit -a
  - git push
  - git tag RELEASE-vm.xx.yy
  - git push origin RELEASE-vm.xx.yy
  - cd _site
  - `scp -r alfred@132.180.198.4:Dokumente/jsxgraph_website/_site/*`   oder `sh ../copy2server.sh *` lokal

## Sourceforge

* Update sourceforge
  - Upload files, click on (i) beneath jsxgraph-m.xx.yy.zip and set checks for default download
* Notify google groups

## NPM

```{.bash}
    npm login (user: alfredw / .NnEGZk!_x2w#J$)
    npm pack # Test what is send to npm!
    npm publish
```

### Publish release candidate

```{.bash}
    npm pack
    npm publish --tag next
    npm install --save jsxgraph@next
```

## Moodle filter

- Update jsxgraphcore.js in repository https://github.com/jsxgraph/moodle-filter_jsxgraph 
for the branches `master` and `MOODLE_2`


